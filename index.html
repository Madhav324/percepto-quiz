<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visual Perceptual Skills</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="translate-styles.css">
    <link rel="stylesheet" href="cvi-colors.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Comic Sans MS', 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 40px 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            background-color: var(--cvi-background);
            position: relative;
            overflow-x: hidden;
        }
        
        /* Animated background with floating shapes */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--cvi-background);
            z-index: -2;
        }
        
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); opacity: 0.7; }
            50% { transform: translateY(-20px) rotate(5deg); opacity: 0.9; }
            100% { transform: translateY(0px) rotate(0deg); opacity: 0.7; }
        }
        
        .bg-shape {
            position: fixed;
            z-index: -1;
            border-radius: 50%;
        }
        
        .bg-shape:nth-child(1) {
            top: 10%;
            left: 10%;
            width: 80px;
            height: 80px;
            background-color: rgba(93, 173, 226, 0.2); /* Primary */
            animation: float 7s ease-in-out infinite;
        }
        
        .bg-shape:nth-child(2) {
            top: 20%;
            right: 15%;
            width: 120px;
            height: 120px;
            background-color: rgba(244, 208, 63, 0.2); /* Accent */
            animation: float 9s ease-in-out infinite 1s;
            border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
        }
        
        .bg-shape:nth-child(3) {
            bottom: 15%;
            left: 20%;
            width: 100px;
            height: 100px;
            background-color: rgba(165, 105, 189, 0.2); /* Support */
            animation: float 8s ease-in-out infinite 0.5s;
            border-radius: 30% 70% 50% 50% / 50% 50% 70% 30%;
        }
        
        .bg-shape:nth-child(4) {
            bottom: 10%;
            right: 10%;
            width: 150px;
            height: 150px;
            background-color: rgba(72, 201, 176, 0.2); /* Positive */
            animation: float 10s ease-in-out infinite 1.5s;
            border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
        }

        .container {
            text-align: center;
            border-radius: 16px;
            background-color: #fff;
            box-shadow: 0px 8px 20px rgba(127, 140, 141, 0.2);
            border: 4px solid var(--cvi-primary); /* Thicker border for visibility */
            width: 90%;
            max-width: 550px;
            padding: 25px;
            margin-top: 20px;
            position: relative;
            animation: container-pulse 2s infinite alternate;
        }
        
        @keyframes container-pulse {
            from { box-shadow: 0px 8px 20px rgba(127, 140, 141, 0.2); }
            to { box-shadow: 0px 12px 25px rgba(93, 173, 226, 0.4); }
        }

        /* Header and profile styles */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #5DADE2; /* Primary color */
            margin: 0;
            font-size: 36px;
            text-shadow: 2px 2px 4px rgba(127, 140, 141, 0.2);
            position: relative;
            display: inline-block;
            animation: title-bounce 3s ease-in-out infinite;
        }
        
        @keyframes title-bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        h2 {
            font-size: 18px;
            color: #333;
            margin-bottom: 15px;
        }
        
        /* Profile Navigation Styles */
        .profile-dropdown {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            z-index: 200;
        }
        
        .profile-icon {
            width: 38px;
            height: 38px;
            background-color: #48C9B0; /* Positive color */
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 3px 6px rgba(127, 140, 141, 0.3);
            border: 2px solid white;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            animation: profile-pulse 2s infinite alternate;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .profile-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 10px rgba(0, 153, 153, 0.7); /* Higher contrast shadow */
        }
        
        /* Ripple effect on profile icon click */
        .profile-icon::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.7) 0%, transparent 70%);
            transform: translate(-50%, -50%) scale(0);
            border-radius: 50%;
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s;
        }
        
        .profile-icon:active::after {
            transform: translate(-50%, -50%) scale(3);
            opacity: 1;
            transition: 0s;
        }
        
        @keyframes profile-pulse {
            0% { box-shadow: 0 3px 6px rgba(72, 201, 176, 0.3); }
            100% { box-shadow: 0 5px 10px rgba(72, 201, 176, 0.6); }
        }
        
        /* Profile Menu */
        .profile-menu {
            position: absolute;
            top: 45px;
            right: 0;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(127, 140, 141, 0.3);
            border: 2px solid #48C9B0; /* Positive color */
            min-width: 160px;
            z-index: 102;
            display: none;
            overflow: hidden;
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .profile-menu.active {
            display: block;
        }
        
        .profile-menu a {
            padding: 12px 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s;
            color: #7F8C8D; /* Text/Base color */
            text-decoration: none;
            font-size: 14px;
            font-weight: bold;
            border-left: 0px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        /* Add icon before menu items */
        .profile-menu a:nth-child(1)::before {
            content: '👤';
            font-size: 16px;
        }
        
        .profile-menu a:nth-child(2)::before {
            content: '🚪';
            font-size: 16px;
        }
        
        /* Add hover effect with slide animation */
        .profile-menu a::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 0;
            background-color: rgba(93, 173, 226, 0.1);
            z-index: -1;
            transition: width 0.3s ease;
        }
        
        .profile-menu a:hover {
            color: #5DADE2; /* Primary color */
            border-left: 4px solid #5DADE2; /* Primary color */
            padding-left: 24px;
        }
        
        .profile-menu a:hover::after {
            width: 100%;
            animation: menu-shine 0.5s forwards;
        }
        
        @keyframes menu-shine {
            0% { opacity: 0.5; }
            50% { opacity: 0.8; }
            100% { opacity: 0.5; }
        }
        
        /* Report Button - Enhanced with gamified elements */
        .report-container {
            margin-bottom: 25px;
            margin-top: 15px;
            position: relative;
        }

        .report-btn {
            display: inline-block;
            padding: 14px 24px;
            background-color: #F4D03F; /* Accent color */
            color: #7F8C8D; /* Text/Base color */
            border-radius: 30px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 6px 0 #F1C40F;
            position: relative;
            overflow: hidden;
            font-size: 16px;
            letter-spacing: 0.5px;
        }

        /* Chart icon for reports */
        .report-btn::before {
            content: '📊';
            margin-right: 8px;
            font-size: 18px;
            vertical-align: middle;
        }

        /* Animated background for report button */
        .report-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.4s;
        }

        .report-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 0 #F1C40F;
            color: #333;
        }

        .report-btn:hover::after {
            left: 100%;
            animation: shine 1.5s infinite;
        }

        .report-btn:active {
            transform: translateY(3px);
            box-shadow: 0 3px 0 #F1C40F;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        /* Child-friendly error message styling */
        .error-message {
            padding: 12px 15px;
            margin: 15px 0;
            color: #7F8C8D;
            background-color: rgba(243, 156, 18, 0.15);
            border-left: 4px solid #F39C12; /* Alert/Warning color */
            border-radius: 8px;
            font-weight: bold;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            transform: translateX(0);
            opacity: 0;
            height: 0;
            transition: all 0.5s ease;
        }
        
        .error-message:not(:empty) {
            opacity: 1;
            height: auto;
            padding: 15px 20px;
            animation: friendly-bounce 0.5s ease-in-out, attention-pulse 2s infinite 1s;
        }
        
        .error-message::before {
            content: '⚠️';
            font-size: 18px;
            margin-right: 10px;
            animation: error-wiggle 1s ease-in-out infinite alternate;
            display: inline-block;
        }
        
        @keyframes friendly-bounce {
            0% { transform: translateY(-20px); opacity: 0; }
            50% { transform: translateY(5px); opacity: 1; }
            75% { transform: translateY(-3px); }
            100% { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes error-wiggle {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(8deg); }
            75% { transform: rotate(-8deg); }
            100% { transform: rotate(0deg); }
        }
        
        @keyframes attention-pulse {
            0% { box-shadow: 0 0 0 0 rgba(243, 156, 18, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(243, 156, 18, 0); }
            100% { box-shadow: 0 0 0 0 rgba(243, 156, 18, 0); }
        }
        
        /* Quiz styles - Enhanced with child-friendly animations */
        .quiz-container {
            text-align: center;
            padding: 15px 0;
            position: relative;
            animation: container-appear 0.6s ease-in-out;
        }
        
        /* Animated button styles */
        .quiz-button {
            position: relative;
            padding: 12px 15px !important;
            overflow: hidden;
            transition: all 0.3s ease;
            transform-style: preserve-3d;
            text-align: left;
        }
        
        .quiz-button i {
            margin-right: 10px;
            display: inline-block;
            transition: all 0.3s ease;
            font-size: 18px;
        }
        
        /* Animations for different button icons */
        .fa-user { animation: mirror-animation 2s infinite alternate; }
        .fa-clone { animation: pulse-animation 2s infinite; }
        .fa-puzzle-piece { animation: rotate-animation 3s infinite linear; }
        .fa-shapes { animation: scale-animation 2s infinite alternate; }
        .fa-layer-group { animation: pulse-animation 3s infinite alternate; }
        .fa-arrows-alt { animation: move-animation 2s infinite alternate; }
        .fa-columns { animation: neglect-animation 3s infinite; }
        .fa-list-ol { animation: sequence-animation 3s infinite; }
        .fa-bookmark { animation: pulse-animation 2s infinite; }
        .fa-running { animation: move-animation 1.5s infinite alternate; }
        .fa-chart-bar { animation: bounce-animation 2s infinite alternate; }
        
        /* Define a bounce animation for the chart icon */
        @keyframes bounce-animation {
            0% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0); }
        }
        
        /* Custom animations for buttons */
        @keyframes mirror-animation {
            0% { transform: translateY(-50%) scaleX(1); }
            100% { transform: translateY(-50%) scaleX(-1); }
        }
        
        @keyframes rotate-animation {
            0% { transform: translateY(-50%) rotate(0deg); }
            100% { transform: translateY(-50%) rotate(360deg); }
        }
        
        @keyframes pulse-animation {
            0% { transform: translateY(-50%) scale(1); opacity: 1; }
            50% { transform: translateY(-50%) scale(1.2); opacity: 0.8; }
            100% { transform: translateY(-50%) scale(1); opacity: 1; }
        }
        
        @keyframes scale-animation {
            0% { transform: translateY(-50%) scale(0.8); }
            100% { transform: translateY(-50%) scale(1.2); }
        }
        
        @keyframes layer-animation {
            0% { transform: translateY(-50%) translateZ(0); }
            100% { transform: translateY(-50%) translateZ(20px); }
        }
        
        @keyframes move-animation {
            0% { transform: translateY(-50%) translateX(-3px); }
            100% { transform: translateY(-50%) translateX(3px); }
        }
        
        @keyframes neglect-animation {
            0% { opacity: 1; transform: translateY(-50%) translateX(0); }
            50% { opacity: 0.5; transform: translateY(-50%) translateX(5px); }
            100% { opacity: 1; transform: translateY(-50%) translateX(0); }
        }
        
        @keyframes sequence-animation {
            0% { transform: translateY(-50%) translateX(0); }
            30% { transform: translateY(-50%) translateX(5px); }
            60% { transform: translateY(-50%) translateX(-5px); }
            100% { transform: translateY(-50%) translateX(0); }
        }
        
        .quiz-button:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .quiz-button:active {
            transform: translateY(2px);
        }
        
        /* Button hover animation with ripple effect */
        .quiz-button::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        .quiz-button:focus::after {
            animation: ripple 1s ease-out;
        }
        
        @keyframes ripple {
            0% { transform: scale(0, 0); opacity: 0.5; }
            20% { transform: scale(25, 25); opacity: 0.5; }
            100% { opacity: 0; transform: scale(40, 40); }
        }
        
        .quiz-container h2 {
            display: inline-block;
            margin-bottom: 20px;
            position: relative;
        }
        
        /* Add decorative stars to heading */
        .quiz-container h2::before,
        .quiz-container h2::after {
            content: '✨';
            font-size: 18px;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            animation: star-twinkle 1.5s ease-in-out infinite alternate;
        }
        
        .quiz-container h2::before {
            left: -25px;
            animation-delay: 0s;
        }
        
        .quiz-container h2::after {
            right: -25px;
            animation-delay: 0.5s;
        }
        
        @keyframes star-twinkle {
            0% { opacity: 0.5; transform: translateY(-50%) scale(0.9) rotate(-5deg); }
            100% { opacity: 1; transform: translateY(-50%) scale(1.1) rotate(5deg); }
        }
        
        @keyframes container-appear {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        /* Decorative stars styling */
        .decoration-stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }
        
        .star {
            position: absolute;
            font-size: 24px;
            animation-duration: 6s;
            animation-timing-function: ease-in-out;
            animation-iteration-count: infinite;
            opacity: 0.7;
        }
        
        .star1 {
            top: 15%;
            left: 10%;
            animation-name: float-diagonal;
        }
        
        .star2 {
            top: 25%;
            right: 15%;
            animation-name: float-circle;
            animation-delay: 1s;
        }
        
        .star3 {
            bottom: 30%;
            left: 20%;
            animation-name: float-zigzag;
            animation-delay: 2s;
        }
        
        @keyframes float-diagonal {
            0% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(30px, -20px) rotate(180deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }
        
        @keyframes float-circle {
            0% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(-15px, 15px) scale(1.1); }
            66% { transform: translate(15px, 15px) scale(0.9); }
            100% { transform: translate(0, 0) scale(1); }
        }
        
        @keyframes float-zigzag {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(20px, -10px) rotate(15deg); }
            50% { transform: translate(0, 10px) rotate(0deg); }
            75% { transform: translate(-20px, -10px) rotate(-15deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }
        
        /* Title highlight styling */
        .title-highlight {
            color: #272323 !important; /* Deep gray/black color with !important to override */
            position: relative;
            display: inline-block;
            font-weight: bold;
            /* No animation for stationary text */
        }
        
        /* Animation removed for stationary text */
        
        /* Removed unused letter-bounce animation */
        /* End of animations */
        
        .quiz-types {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 5px;
            width: 100%;
            margin-top: 5px;
            position: relative;
            z-index: 2;
            perspective: 1000px;
        }
        
        /* Mobile optimizations */
        @media (max-width: 480px) {
            .quiz-container {
                max-width: 100% !important;
                padding: 5px !important;
                margin: 0 !important;
            }
            
            .quiz-types {
                grid-template-columns: repeat(2, 1fr) !important; /* Same 2-column layout as desktop */
                gap: 4px !important;
                width: 100% !important;
                margin-top: 3px !important;
            }
            
            .quiz-button {
                min-height: 30px !important;
                padding: 2px 4px !important;
                font-size: 0.85rem !important;
                white-space: normal !important;
                overflow-wrap: break-word !important;
                word-break: break-word !important;
            }
            
            h1 {
                font-size: 14px !important;
                margin: 0 0 3px 0 !important;
            }
            
            .report-btn {
                padding: 6px 10px !important;
                font-size: 0.85rem !important;
            }
            
            /* Only for portrait orientation where width is limited */
            @media (orientation: portrait) {
                .quiz-button {
                    font-size: 0.8rem !important;
                }
            }
        }
        
        .quiz-types a {
            transform-style: preserve-3d;
        }
        
        /* Make quiz buttons appear in sequence */
        .quiz-types a {
            opacity: 0;
            transform: translateY(20px);
            animation: staggered-appear 0.5s ease-in-out forwards;
        }
        
        /* Staggered appearance animation for quiz buttons */
        @keyframes staggered-appear {
            0% { opacity: 0; transform: translateY(20px) scale(0.9); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        /* Apply staggered delay to each button */
        .quiz-types a:nth-child(1) { animation-delay: 0.1s; }
        .quiz-types a:nth-child(2) { animation-delay: 0.15s; }
        .quiz-types a:nth-child(3) { animation-delay: 0.2s; }
        .quiz-types a:nth-child(4) { animation-delay: 0.25s; }
        .quiz-types a:nth-child(5) { animation-delay: 0.3s; }
        .quiz-types a:nth-child(6) { animation-delay: 0.35s; }
        .quiz-types a:nth-child(7) { animation-delay: 0.4s; }
        .quiz-types a:nth-child(8) { animation-delay: 0.45s; }
        .quiz-types a:nth-child(9) { animation-delay: 0.5s; }
        .quiz-types a:nth-child(10) { animation-delay: 0.55s; }
        
        .quiz-button {
            padding: 15px 12px;
            border: none;
            background-color: #5DADE2; /* Primary color */
            color: white;
            font-size: 17px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 12px;
            width: 100%;
            height: 70px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 6px 0 #3498DB;
            position: relative;
            top: 0;
            text-decoration: none;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .quiz-button:hover {
            background-color: #3498DB;
            transform: translateY(-3px);
            box-shadow: 0 9px 0 #2E86C1;
        }
        
        .quiz-button:active {
            transform: translateY(3px);
            box-shadow: 0 3px 0 #2E86C1;
        }
        
        /* Add different colors to quiz buttons for variety */
        .quiz-types a:nth-child(4n+1) .quiz-button {
            background-color: #5DADE2; /* Primary */
            box-shadow: 0 6px 0 #3498DB;
        }
        
        .quiz-types a:nth-child(4n+2) .quiz-button {
            background-color: #F4D03F; /* Accent */
            box-shadow: 0 6px 0 #F1C40F;
        }
        
        .quiz-types a:nth-child(4n+3) .quiz-button {
            background-color: #A569BD; /* Support */
            box-shadow: 0 6px 0 #8E44AD;
        }
        
        .quiz-types a:nth-child(4n+4) .quiz-button {
            background-color: #48C9B0; /* Positive */
            box-shadow: 0 6px 0 #1ABC9C;
        }
        
        /* Add subtle animation to quiz buttons */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        .quiz-types a .quiz-button {
            animation: pulse 2s infinite;
        }
        
        .quiz-types a:nth-child(1) .quiz-button { animation-delay: 0.1s; }
        .quiz-types a:nth-child(2) .quiz-button { animation-delay: 0.3s; }
        .quiz-types a:nth-child(3) .quiz-button { animation-delay: 0.5s; }
        .quiz-types a:nth-child(4) .quiz-button { animation-delay: 0.7s; }
        .quiz-types a:nth-child(5) .quiz-button { animation-delay: 0.9s; }
        .quiz-types a:nth-child(6) .quiz-button { animation-delay: 1.1s; }
        .quiz-types a:nth-child(7) .quiz-button { animation-delay: 1.3s; }
        .quiz-types a:nth-child(8) .quiz-button { animation-delay: 1.5s; }
        .quiz-types a:nth-child(9) .quiz-button { animation-delay: 1.7s; }
        .quiz-types a:nth-child(10) .quiz-button { animation-delay: 1.9s; }
        
        /* Form styles */
        .form-container {
            max-width: 350px;
            margin: 0 auto;
            text-align: left;
        }
        
        .form-group {
            margin-bottom: 12px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        
        input[type="text"],
        input[type="email"],
        input[type="password"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 15px;
        }
        
        .primary-btn {
            display: inline-block;
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 15px;
            transition: background-color 0.3s;
        }
        
        .primary-btn:hover {
            background-color: #45a049;
        }
        
        /* Patients button */
        #patientsBtn {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            margin-left: 10px;
            gap: 6px;
            transition: all 0.3s;
        }
        
        #patientsBtn:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }
        
        /* Error message */
        .error-message {
            color: #d9534f;
            margin-top: 10px;
            font-size: 13px;
        }
        
        /* Next button */
        #next-button {
            display: none;
        }
        
        /* Result container */
        #result-container h2 {
            color: #333;
        }
        
        /* Responsive adjustments */
        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .header {
                flex-direction: column;
                gap: 10px;
            }
            
            .quiz-types {
                grid-template-columns: 1fr;
            }
        }
        
        .report-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            padding: 6px 12px;
            margin-left: 10px;
            transition: all 0.3s;
        }
        
        .report-btn:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }
        
        .report-container {
            text-align: center;
            margin-bottom: 15px;
        }
        
        .user-name {
            font-size: 15px;
            color: #333;
            margin-right: 8px;
        }
            h2 {
            font-size: 22px;
            color: #7F8C8D; /* Text/Base color */
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
            padding: 0 15px;
        }
        
        h2:before, h2:after {
            content: '★';
            color: #F4D03F; /* Accent color - warm yellow */
            position: absolute;
            top: 0;
        }
        
        h2:before {
            left: -10px;
        }
        
        h2:after {
            right: -10px;
        }
        
        /* Action buttons for next, restart quiz, etc. */
        #next-button, button[onclick="restartQuiz()"], .primary-btn {
            background-color: #48C9B0; /* Positive color */
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 0 #1ABC9C;
            position: relative;
            top: 0;
            margin: 10px 5px;
        }
        
        #next-button:hover, button[onclick="restartQuiz()"]:hover, .primary-btn:hover {
            background-color: #1ABC9C;
            transform: translateY(-3px);
            box-shadow: 0 8px 0 #16A085;
        }
        
        #next-button:active, button[onclick="restartQuiz()"]:active, .primary-btn:active {
            transform: translateY(3px);
            box-shadow: 0 2px 0 #16A085;
        }
        
        button[onclick="restartQuiz()"] {
            background-color: #F39C12; /* Alert/Warning color */
            box-shadow: 0 5px 0 #D35400;
        }
        
        button[onclick="restartQuiz()"]:hover {
            background-color: #D35400;
            box-shadow: 0 8px 0 #A04000;
        }
        
        /* Score display styling */
        #score {
            color: #F4D03F; /* Accent color */
            font-weight: bold;
            font-size: 130%;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }
        
        /* Floating background shapes */
        .bg-shape {
            position: fixed;
            z-index: -1;
            border-radius: 50%;
            animation: float 8s infinite ease-in-out;
            filter: blur(2px);
        }
        
        .bg-shape:nth-child(1) {
            top: 10%;
            left: 10%;
            width: 120px;
            height: 120px;
            background-color: rgba(93, 173, 226, 0.2); /* Primary */
            animation-delay: 0s;
        }
        
        .bg-shape:nth-child(2) {
            top: 20%;
            right: 15%;
            width: 150px;
            height: 150px;
            background-color: rgba(244, 208, 63, 0.2); /* Accent */
            animation-delay: 1s;
            border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
        }
        
        .bg-shape:nth-child(3) {
            bottom: 15%;
            left: 20%;
            width: 130px;
            height: 130px;
            background-color: rgba(165, 105, 189, 0.2); /* Support */
            animation-delay: 0.5s;
            border-radius: 30% 70% 50% 50% / 50% 50% 70% 30%;
        }
        
        .bg-shape:nth-child(4) {
            bottom: 10%;
            right: 10%;
            width: 180px;
            height: 180px;
            background-color: rgba(72, 201, 176, 0.2); /* Positive */
            animation-delay: 1.5s;
            border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
        }
        
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); opacity: 0.5; }
            25% { transform: translateY(-15px) rotate(3deg); opacity: 0.7; }
            50% { transform: translateY(-25px) rotate(5deg); opacity: 0.8; }
            75% { transform: translateY(-15px) rotate(2deg); opacity: 0.7; }
            100% { transform: translateY(0) rotate(0deg); opacity: 0.5; }
        }
        
        /* Enhanced interactive quiz buttons */
        .quiz-button {
            position: relative;
            overflow: hidden;
            z-index: 1;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        /* Sparkle effect when hovering */
        .quiz-button::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background-image: radial-gradient(circle, rgba(255,255,255,0.8) 10%, transparent 10%), 
                           radial-gradient(circle, rgba(255,255,255,0.5) 15%, transparent 15%),
                           radial-gradient(circle, rgba(255,255,255,0.3) 20%, transparent 20%);
            background-size: 30px 30px, 20px 20px, 15px 15px;
            background-position: 0 0, 15px 15px, 30px 30px;
            opacity: 0;
            transform: scale(0.5);
            transition: opacity 0.4s, transform 0.4s;
            pointer-events: none;
            z-index: -1;
        }
        
        .quiz-button:hover::before {
            opacity: 0.7;
            transform: scale(1);
            animation: sparkle 2s infinite linear;
        }
        
        /* Floating icons effect on hover - gamification element */
        .quiz-button::after {
            content: '🌟';
            position: absolute;
            font-size: 20px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
            transition: all 0.3s;
            pointer-events: none;
        }
        
        .quiz-types a:nth-child(4n+1) .quiz-button::after { content: '🌟'; }
        .quiz-types a:nth-child(4n+2) .quiz-button::after { content: '✨'; }
        .quiz-types a:nth-child(4n+3) .quiz-button::after { content: '💫'; }
        .quiz-types a:nth-child(4n+4) .quiz-button::after { content: '⭐'; }
        
        .quiz-button:hover::after {
            opacity: 1;
            transform: translate(-50%, -150%) scale(1.5);
            animation: float-up 1.5s forwards;
        }
        
        @keyframes sparkle {
            0% { background-position: 0 0, 15px 15px, 30px 30px; }
            100% { background-position: 30px 30px, 45px 45px, 60px 60px; }
        }
        
        @keyframes float-up {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            20% { transform: translate(-50%, -100%) scale(1); opacity: 1; }
            80% { transform: translate(-50%, -200%) scale(1); opacity: 0.8; }
            100% { transform: translate(-50%, -250%) scale(0.5); opacity: 0; }
        }
        
        /* Add little bounce on click */
        .quiz-button:active {
            transform: translateY(5px) scale(0.95);
            animation: button-pop 0.4s forwards;
        }
        
        @keyframes button-pop {
            0% { transform: translateY(5px) scale(0.95); }
            50% { transform: translateY(-2px) scale(1.02); }
            100% { transform: translateY(0) scale(1); }
        }
    </style>
</head>
<body>
    <!-- Floating background shapes -->
    <div class="bg-shape"></div>
    <div class="bg-shape"></div>
    <div class="bg-shape"></div>
    <div class="bg-shape"></div>
    
    <!-- Hidden Google Translate element -->
    <div id="google_translate_element" style="display:none;"></div>
    
    
    
    <div class="container">
        <!-- Added decorative elements for gamification -->
        <div class="decoration-stars">
            <div class="star star1">⭐</div>
            <div class="star star2">✨</div>
            <div class="star star3">🌟</div>
        </div>

        <div class="header" style="margin-bottom: 5px;">
            <h1 style="margin: 0 0 5px 0;"><span class="title-highlight">Percepto</span></h1>
            <div class="profile-dropdown">
                <span id="userName" class="user-name">User</span>
                <div class="profile-icon" id="profileIcon" style="width: 30px; height: 30px; line-height: 30px; font-size: 14px;">P</div>
                <div class="profile-menu" id="profileMenu">
                    <a href="#" onclick="editProfile()">Profile</a>
                    <a href="#" onclick="logout()">Logout</a>
                </div>
            </div>
        </div>

        <div class="report-container" style="margin: 0 0 5px 0;">
            <a href="reports.html" class="report-btn" style="display: inline-block; padding: 8px 12px; margin: 0; border: none; background-color: #9966CC; color: white; font-size: 14px; cursor: pointer; border-radius: 4px; text-decoration: none; position: relative; transition: all 0.3s ease; transform-style: preserve-3d;">View Reports</a>
        </div>
        
        <div id="error-message" class="error-message" style="margin: 0; padding: 3px 0;"></div>

        <div class="quiz-container" id="quizContainer" style="display: none; max-width: 630px; padding: 10px; margin: 0 auto;">
            <h1 style="margin: 0 0 5px 0; font-size: 16px;">Time for some fun!</h1>
            <!-- Quiz Type Selection -->
            <div class="quiz-types" id="quiz-type" style="gap: 5px;">
                <a href="mirror.html" style="text-decoration: none;"><button class="quiz-button" style="min-height: 30px; padding: 3px 5px; font-size: 0.9rem;"><i class="fas fa-user"></i> Fixation to Mirror</button></a>
                <a href="VD.html" style="text-decoration: none;"><button class="quiz-button" style="min-height: 30px; padding: 3px 5px; font-size: 0.9rem;"><i class="fas fa-clone"></i> Visual Discrimination</button></a>
                <a href="VC.html" style="text-decoration: none;"><button class="quiz-button" style="min-height: 30px; padding: 3px 5px; font-size: 0.9rem;"><i class="fas fa-puzzle-piece"></i> Visual Closure</button></a>
                <a href="VFC.html" style="text-decoration: none;"><button class="quiz-button" style="min-height: 30px; padding: 3px 5px; font-size: 0.9rem;"><i class="fas fa-shapes"></i> Visual Form Constancy</button></a>
                <a href="FG.html" style="text-decoration: none;"><button class="quiz-button" style="min-height: 30px; padding: 3px 5px; font-size: 0.9rem;"><i class="fas fa-layer-group"></i> Figure Ground</button></a>
                <a href="Vspac.html" style="text-decoration: none;"><button class="quiz-button" style="min-height: 30px; padding: 3px 5px; font-size: 0.9rem;"><i class="fas fa-arrows-alt"></i> Spatial Relations</button></a>
                <a href="VN.html" style="text-decoration: none;"><button class="quiz-button" style="min-height: 30px; padding: 3px 5px; font-size: 0.9rem;"><i class="fas fa-columns"></i> Visual Neglect</button></a>
                <a href="VSM.html" style="text-decoration: none;"><button class="quiz-button" style="min-height: 30px; padding: 3px 5px; font-size: 0.9rem;"><i class="fas fa-list-ol"></i> Visual Sequential Memory</button></a>
                <a href="VM1.html" style="text-decoration: none;"><button class="quiz-button" style="min-height: 30px; padding: 3px 5px; font-size: 0.9rem;"><i class="fas fa-bookmark"></i> Visual Memory</button></a>
                <a href="Vmotion1.html" style="text-decoration: none;"><button class="quiz-button" style="min-height: 30px; padding: 3px 5px; font-size: 0.9rem;"><i class="fas fa-running"></i> Motion Perception</button></a>
            </div>

            <!-- Quiz Questions -->
            <div id="questions-container" style="display:none;">
                <h2 id="quiz-title"></h2>
                <div id="question-container"></div>
                <button id="next-button" onclick="nextQuestion()">Next</button>
            </div>

            <!-- Results -->
            <div id="result-container" style="display:none;">
                <h2>Your Score: <span id="score"></span></h2>
                <button onclick="restartQuiz()">Restart Quiz</button>
            </div>
        </div>

        <div id="doctorMessage" class="doctor-message" style="display: none;">
            <h2>Doctor's Dashboard</h2>
            <p>As a doctor, you can manage your patients and view their quiz results. You cannot take quizzes yourself.</p>
            <button class="primary-btn" onclick="window.location.href='patients.html'">Manage Patients</button>
        </div>

        <!-- Firebase App (the core Firebase SDK) -->
        <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
        <!-- Firebase Auth -->
        <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
        <!-- Firebase Firestore -->
        <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
        <!-- Firebase Realtime Database -->
        <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

        <script>
            // Firebase configuration
            const firebaseConfig = {
                apiKey: "AIzaSyDFENL5Z_2Cewh4p6zp_BZtxL9n0di-9u8",
                authDomain: "projeccvi.firebaseapp.com",
                projectId: "projeccvi",
                storageBucket: "projeccvi.firebasestorage.app",
                messagingSenderId: "279067566247",
                appId: "1:279067566247:web:9cf00f7bf1ea3549fabb82"
            };

            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            const db = firebase.firestore();
            const database = firebase.database();
            
            // Handle relative paths for both local and GitHub Pages
            function getPath(page) {
                const baseUrl = window.location.href.split('/').slice(0, -1).join('/');
                return `${baseUrl}/${page}`;
            }

            // Profile dropdown
            const profileIcon = document.getElementById('profileIcon');
            const profileMenu = document.getElementById('profileMenu');
            
            profileIcon.addEventListener('click', (e) => {
                e.stopPropagation();
                profileMenu.classList.toggle('active');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!profileMenu.contains(e.target) && !profileIcon.contains(e.target)) {
                    profileMenu.classList.remove('active');
                }
            });

            // Profile navigation
            function goToProfile() {
                sessionStorage.setItem('editingProfile', 'true');
                window.location.href = getPath('profile.html');
            }

            // Check if user is a doctor and show patients button
            async function checkIfDoctor(userId) {
                try {
                    const doctorSnapshot = await db.collection('doctorProfiles').doc(userId).get();
                    const patientsButton = document.getElementById('patientsButton');
                    patientsButton.style.display = doctorSnapshot.exists() ? 'inline-flex' : 'none';
                } catch (error) {
                    console.error('Error checking doctor status:', error);
                }
            }

            // Quiz state
            let userEmail = '';
            let currentPatientId = null;
            let doctorId = null;
            let isPatientQuiz = false;

            // Load quiz state
            async function loadQuizState() {
                currentPatientId = sessionStorage.getItem('currentPatientId');
                doctorId = sessionStorage.getItem('doctorId');
                isPatientQuiz = !!currentPatientId;

                const user = auth.currentUser;
                if (!user) return;

                // Check if user is a doctor
                const roleSnapshot = await database.ref(`roles/${user.uid}`).once('value');
                const role = roleSnapshot.val();

                if (role === 'doctor') {
                    if (!currentPatientId) {
                        // If doctor is not accessing as a patient, show doctor message
                        document.getElementById('quizContainer').style.display = 'none';
                        document.getElementById('doctorMessage').style.display = 'block';
                        return;
                    }
                }

                // Show quiz container for patients and regular users
                document.getElementById('quizContainer').style.display = 'block';
                document.getElementById('doctorMessage').style.display = 'none';
            }

            // Start quiz function
            async function startQuiz(quizType) {
                const user = auth.currentUser;
                if (!user) return;

                // Check if user is a doctor
                const roleSnapshot = await database.ref(`roles/${user.uid}`).once('value');
                const role = roleSnapshot.val();

                if (role === 'doctor' && !currentPatientId) {
                    showError('Doctors cannot take quizzes directly. Please select a patient first.');
                    return;
                }

                console.log(`Starting quiz: ${quizType}, Patient ID: ${currentPatientId || 'none'}`);
                
                // For Visual Discrimination quizzes, go to category page first
                if (quizType === 'VD') {
                    window.location.href = 'VD.html';
                } else {
                    // For other quizzes, go directly to the quiz
                    window.location.href = `${quizType}.html`;
                }
            }

            // Logout function
            function logout() {
                if (isPatientQuiz) {
                    // For patient quiz mode, just remove patient-specific data
                    // but keep doctor authentication
                    sessionStorage.removeItem('currentPatientId');
                    sessionStorage.removeItem('isPatientQuiz');
                    window.location.href = 'patients.html';
                } else {
                    // For regular user logout, clear everything
                    sessionStorage.clear();
                    auth.signOut().then(() => {
                        console.log('Logged out successfully');
                        window.location.href = 'login.html';
                    }).catch((error) => {
                        console.error('Logout error:', error);
                    });
                }
            }

            // View report function
            async function viewReport() {
                const user = auth.currentUser;
                if (!user) {
                    showError('Not signed in');
                    return;
                }

                try {
                    if (isPatientQuiz && currentPatientId && doctorId) {
                        // Check patient's quiz results
                        const resultsRef = database.ref(`doctors/${doctorId}/patients/${currentPatientId}/quiz`);
                        const resultsSnap = await resultsRef.once('value');
                        
                        if (!resultsSnap.exists()) {
                            showError('No quiz results found yet. Take a quiz first!');
                            return;
                        }
                    } else {
                        // Get user role
                        const roleSnapshot = await database.ref(`roles/${user.uid}`).once('value');
                        const role = roleSnapshot.val();
                        // Check user's quiz results
                        const resultsRef = database.ref(`${role}s/${user.uid}/quiz`);
                        const resultsSnap = await resultsRef.once('value');
                        
                        if (!resultsSnap.exists()) {
                            showError('No quiz results found yet. Take a quiz first!');
                            return;
                        }
                    }

                    // If we have results, go to report page
                    window.location.href = 'report.html';
                } catch (error) {
                    console.error('Error checking results:', error);
                    showError('Failed to load report. Please try again.');
                }
            }

            // Save quiz result
            async function saveQuizResult(quizType, score, details) {
                const user = auth.currentUser;
                if (!user) return;

                const timestamp = new Date().toISOString();
                const resultData = {
                    score,
                    timestamp,
                    details
                };

                try {
                    if (isPatientQuiz && currentPatientId && doctorId) {
                        // Save to patient's quiz results
                        await database.ref(`doctors/${doctorId}/patients/${currentPatientId}/quiz/${quizType}/${timestamp}`).set(resultData);
                    } else {
                        // Get user role
                        const roleSnapshot = await database.ref(`roles/${user.uid}`).once('value');
                        const role = roleSnapshot.val() || 'user';
                        
                        if (role === 'doctor') {
                            showError('Doctors cannot take quizzes. Please manage your patients instead.');
                            return;
                        }
                        
                        // Save to user's quiz results
                        await database.ref(`${role}s/${user.uid}/quiz/${quizType}/${timestamp}`).set(resultData);
                    }
                    showError('Quiz result saved successfully!', true);
                } catch (error) {
                    console.error('Error saving quiz result:', error);
                    showError('Failed to save quiz result');
                }
            }

            // Auth state observer
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    userEmail = user.email;
                    await checkIfDoctor(user.uid);
                    loadQuizState();
                    
                    // Load user name
                    try {
                        let profileRef;
                        if (isPatientQuiz && currentPatientId) {
                            // If accessing as a patient, get patient's profile
                            profileRef = database.ref(`doctors/${doctorId}/patients/${currentPatientId}/profile`);
                        } else {
                            // Get role to determine path
                            const roleSnapshot = await database.ref(`roles/${user.uid}`).once('value');
                            const role = roleSnapshot.val();
                            profileRef = database.ref(`${role}s/${user.uid}/profile`);
                        }
                        
                        const snapshot = await profileRef.once('value');
                        const profile = snapshot.val();
                        if (profile && profile.name) {
                            document.getElementById('userName').textContent = profile.name;
                        } else {
                            document.getElementById('userName').textContent = 'User';
                        }
                    } catch (error) {
                        console.error('Error loading profile:', error);
                        document.getElementById('userName').textContent = 'User';
                    }
                    
                    document.getElementById('quiz-container').style.display = 'block';
                } else {
                    window.location.href = 'login.html';
                }
            });

            // Initialize profile icon and name
            async function initializeProfileIcon() {
                const user = auth.currentUser;
                if (!user) return;
                
                try {
                    let profile;
                    let userDisplayName;
                    let initial = 'U';
                    
                    // Check if this is a patient quiz
                    const currentPatientId = sessionStorage.getItem('currentPatientId');
                    const doctorId = sessionStorage.getItem('doctorId');
                    const isPatientQuiz = !!currentPatientId;
                    
                    if (isPatientQuiz) {
                        // Doctor viewing patient
                        console.log(`Loading patient profile: ${currentPatientId}`);
                        const patientSnapshot = await database.ref(`doctors/${doctorId}/patients/${currentPatientId}/profile`).once('value');
                        profile = patientSnapshot.val();
                        
                        if (profile && profile.name) {
                            userDisplayName = profile.name + " (Patient)";
                            initial = profile.name.charAt(0).toUpperCase();
                        } else {
                            userDisplayName = "Patient";
                            initial = "P";
                        }
                    } else {
                        // Get user role
                        const roleSnapshot = await database.ref(`roles/${user.uid}`).once('value');
                        const role = roleSnapshot.val() || 'user';
                        
                        if (role === 'doctor') {
                            // Doctor
                            console.log('Loading doctor profile');
                            const doctorSnapshot = await database.ref(`doctors/${user.uid}/profile`).once('value');
                            profile = doctorSnapshot.val();
                            
                            if (profile && profile.name) {
                                userDisplayName = "Dr. " + profile.name;
                                initial = profile.name.charAt(0).toUpperCase();
                            } else {
                                userDisplayName = "Doctor";
                                initial = "D";
                            }
                        } else {
                            // Regular user
                            console.log('Loading user profile');
                            const userSnapshot = await database.ref(`users/${user.uid}/profile`).once('value');
                            profile = userSnapshot.val();
                            
                            if (profile && profile.name) {
                                userDisplayName = profile.name;
                                initial = profile.name.charAt(0).toUpperCase();
                            } else if (user.email) {
                                userDisplayName = user.email.split('@')[0];
                                initial = user.email.charAt(0).toUpperCase();
                            }
                        }
                    }
                    
                    // Set profile icon and user name
                    const profileIcon = document.getElementById('profileIcon');
                    if (profileIcon) {
                        profileIcon.textContent = initial;
                    }
                    
                    const userName = document.getElementById('userName');
                    if (userName) {
                        userName.textContent = userDisplayName;
                    }
                    
                    // Enable correct UI elements based on role
                    const quizContainer = document.getElementById('quizContainer');
                    if (quizContainer) {
                        quizContainer.style.display = 'block';
                    }
                    
                    const doctorMessage = document.getElementById('doctorMessage');
                    if (doctorMessage) {
                        doctorMessage.style.display = 'none';
                    }
                } catch (error) {
                    console.error('Error in profile initialization:', error);
                    
                    const profileIcon = document.getElementById('profileIcon');
                    if (profileIcon) {
                        profileIcon.textContent = user.email ? user.email.charAt(0).toUpperCase() : 'U';
                    }
                    
                    const userName = document.getElementById('userName');
                    if (userName) {
                        userName.textContent = user.email ? user.email.split('@')[0] : 'User';
                    }
                }
            }

            function editProfile() {
                const currentPatientId = sessionStorage.getItem('currentPatientId');
                if (currentPatientId) {
                    // If accessing as a patient, go to patient profile page
                    window.location.href = 'patient_profile.html';
                } else {
                    // Regular user/doctor profile
                    window.location.href = 'profile.html';
                }
            }

            function logout() {
                const currentPatientId = sessionStorage.getItem('currentPatientId');
                if (currentPatientId) {
                    // If accessing as a patient, clear session and return to patients.html
                    sessionStorage.removeItem('currentPatientId');
                    sessionStorage.removeItem('doctorId');
                    window.location.href = 'patients.html';
                } else {
                    // Regular logout
                    auth.signOut()
                        .then(() => {
                            sessionStorage.clear();
                            window.location.href = 'login.html';
                        })
                        .catch(error => console.error('Error logging out:', error));
                }
            }

            // Auth state observer
            auth.onAuthStateChanged(user => {
                if (user) {
                    initializeProfileIcon();
                } else {
                    const currentPatientId = sessionStorage.getItem('currentPatientId');
                    if (!currentPatientId) {
                        window.location.href = 'login.html';
                    }
                }
            });
        </script>
        <script src="script.js"></script>
        <!-- Google Translate Integration -->
        <script src="translate.js"></script>
        <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit" async></script>
    </body>
</html>